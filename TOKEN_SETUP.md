# ğŸ”‘ Threads API ãƒˆãƒ¼ã‚¯ãƒ³ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰

ã“ã®ã‚¬ã‚¤ãƒ‰ã§ã¯ã€çŸ­æœŸãƒˆãƒ¼ã‚¯ãƒ³ã‹ã‚‰é•·æœŸãƒˆãƒ¼ã‚¯ãƒ³ï¼ˆ60æ—¥é–“æœ‰åŠ¹ï¼‰ã‚’å–å¾—ã—ã€è‡ªå‹•æŠ•ç¨¿ã‚’è¨­å®šã™ã‚‹æ‰‹é †ã‚’èª¬æ˜ã—ã¾ã™ã€‚

---

## ğŸ“‹ äº‹å‰æº–å‚™

### 1. Meta App ã‚’ä½œæˆ

1. https://developers.facebook.com/apps/ ã«ã‚¢ã‚¯ã‚»ã‚¹
2. ã€ŒCreate Appã€ã‚’ã‚¯ãƒªãƒƒã‚¯
3. App Type: **Business** ã‚’é¸æŠ
4. App Name ã‚’å…¥åŠ›ã—ã¦ä½œæˆ

### 2. Threads API ã‚’æœ‰åŠ¹åŒ–

1. ä½œæˆã—ãŸã‚¢ãƒ—ãƒªã®ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚’é–‹ã
2. å·¦ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ã€ŒAdd Productsã€ã‚’é¸æŠ
3. **Threads** ã‚’é¸æŠã—ã¦ã€ŒSet Upã€
4. æ¨©é™ã‚’è¨­å®š:
   - `threads_basic`
   - `threads_content_publish`

### 3. å¿…è¦ãªæƒ…å ±ã‚’å–å¾—

#### **App Secret ã‚’å–å¾—:**
1. å·¦ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã€ŒSettingsã€â†’ã€ŒBasicã€
2. **App Secret** ã‚’ã‚³ãƒ”ãƒ¼ï¼ˆã€ŒShowã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦è¡¨ç¤ºï¼‰
   - âš ï¸ ã“ã®å€¤ã¯æ©Ÿå¯†æƒ…å ±ã§ã™ã€‚çµ¶å¯¾ã«å…¬é–‹ã—ãªã„ã§ãã ã•ã„

#### **çŸ­æœŸã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—:**
1. https://developers.facebook.com/tools/explorer/ ã«ã‚¢ã‚¯ã‚»ã‚¹
2. ä½œæˆã—ãŸã‚¢ãƒ—ãƒªã‚’é¸æŠ
3. ã€ŒGenerate Access Tokenã€ã‚’ã‚¯ãƒªãƒƒã‚¯
4. å¿…è¦ãªæ¨©é™ã‚’é¸æŠ:
   - `threads_basic`
   - `threads_content_publish`
5. ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ã‚³ãƒ”ãƒ¼

---

## ğŸš€ é•·æœŸãƒˆãƒ¼ã‚¯ãƒ³å–å¾—æ‰‹é †

### ã‚¹ãƒ†ãƒƒãƒ—1: ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œ

```bash
python3 setup_long_lived_token.py
```

### ã‚¹ãƒ†ãƒƒãƒ—2: æƒ…å ±ã‚’å…¥åŠ›

ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒä»¥ä¸‹ã‚’é †ç•ªã«èã„ã¦ãã¾ã™ï¼š

1. **çŸ­æœŸã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³**
   ```
   çŸ­æœŸã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:
   > [Meta Graph API Explorer ã§ã‚³ãƒ”ãƒ¼ã—ãŸãƒˆãƒ¼ã‚¯ãƒ³ã‚’è²¼ã‚Šä»˜ã‘]
   ```

2. **App Secret**
   ```
   Meta App ã® App Secret ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:
   > [App Settings ã§ã‚³ãƒ”ãƒ¼ã—ãŸ App Secret ã‚’è²¼ã‚Šä»˜ã‘]
   ```

### ã‚¹ãƒ†ãƒƒãƒ—3: è‡ªå‹•å‡¦ç†

ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒä»¥ä¸‹ã‚’è‡ªå‹•ã§å®Ÿè¡Œã—ã¾ã™ï¼š

1. âœ… ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’å–å¾—ï¼ˆUser ID, Usernameï¼‰
2. âœ… é•·æœŸãƒˆãƒ¼ã‚¯ãƒ³ã«äº¤æ›ï¼ˆ60æ—¥é–“æœ‰åŠ¹ï¼‰
3. âœ… `.env` ãƒ•ã‚¡ã‚¤ãƒ«ã«å±¥æ­´ã¨å…±ã«ä¿å­˜

**å®Ÿè¡Œä¾‹:**
```
======================================================================
Threads API é•·æœŸãƒˆãƒ¼ã‚¯ãƒ³å–å¾—ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
======================================================================

ğŸ“‹ ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’å–å¾—ä¸­...
âœ… ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±å–å¾—æˆåŠŸ
   User ID: 1234567890
   Username: @your_username

ğŸ”„ é•·æœŸãƒˆãƒ¼ã‚¯ãƒ³ã«äº¤æ›ä¸­...
âœ… é•·æœŸãƒˆãƒ¼ã‚¯ãƒ³å–å¾—æˆåŠŸ
   Token Type: Bearer
   æœ‰åŠ¹æœŸé™: 60æ—¥é–“
   æœŸé™æ—¥: 2025-12-29 10:35:00

âœ… .envãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ›´æ–°ã—ã¾ã—ãŸ: .env

======================================================================
âœ… ã™ã¹ã¦ã®å‡¦ç†ãŒå®Œäº†ã—ã¾ã—ãŸï¼
======================================================================
```

---

## ğŸ“ `.env` ãƒ•ã‚¡ã‚¤ãƒ«ã®å½¢å¼

ã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Ÿè¡Œå¾Œã€`.env` ãƒ•ã‚¡ã‚¤ãƒ«ã«ä»¥ä¸‹ã®ã‚ˆã†ã«è¨˜éŒ²ã•ã‚Œã¾ã™ï¼š

```env
# ================================================
# Token Update: 2025-10-30 10:35:00 JST
# ================================================

# [1] çŸ­æœŸãƒˆãƒ¼ã‚¯ãƒ³å–å¾— - 2025-10-30 10:35:00 JST
THREADS_ACCESS_TOKEN_SHORT=THQVJNRk1...

# [2] ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±å–å¾— - 2025-10-30 10:35:00 JST
THREADS_USER_ID=1234567890
THREADS_USERNAME=your_username

# [3] é•·æœŸãƒˆãƒ¼ã‚¯ãƒ³å–å¾— - 2025-10-30 10:35:00 JST
# æœ‰åŠ¹æœŸé™: 60æ—¥é–“ (æœŸé™æ—¥: 2025-12-29)
THREADS_ACCESS_TOKEN=THAASu6I...

# ================================================
# ä»¥ä¸‹ã¯éå»ã®å±¥æ­´
# ================================================
```

---

## ğŸ” GitHub Secrets ã‚’æ›´æ–°

`.env` ãƒ•ã‚¡ã‚¤ãƒ«ã®æƒ…å ±ã‚’ GitHub Secrets ã«ç™»éŒ²ã—ã¾ã™ï¼š

### 1. GitHub ãƒªãƒã‚¸ãƒˆãƒªã®è¨­å®šã‚’é–‹ã

https://github.com/ibkuroyagi/threads_auto/settings/secrets/actions

### 2. ä»¥ä¸‹ã®ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚’æ›´æ–°

| ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆå | å€¤ | èª¬æ˜ |
|--------------|-----|------|
| `THREADS_ACCESS_TOKEN` | `.env` ã® `THREADS_ACCESS_TOKEN` ã®å€¤ | é•·æœŸãƒˆãƒ¼ã‚¯ãƒ³ï¼ˆ60æ—¥é–“æœ‰åŠ¹ï¼‰ |
| `THREADS_USER_ID` | `.env` ã® `THREADS_USER_ID` ã®å€¤ | ã‚ãªãŸã® Threads User ID |

### 3. æ›´æ–°æ–¹æ³•

1. æ—¢å­˜ã®ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚’ã‚¯ãƒªãƒƒã‚¯
2. ã€ŒUpdate secretã€ã‚’ã‚¯ãƒªãƒƒã‚¯
3. `.env` ã‹ã‚‰ã‚³ãƒ”ãƒ¼ã—ãŸå€¤ã‚’è²¼ã‚Šä»˜ã‘
4. ã€ŒUpdate secretã€ã‚’ä¿å­˜

---

## âœ… å‹•ä½œç¢ºèª

### 1. GitHub Actions ã§æ‰‹å‹•å®Ÿè¡Œ

1. https://github.com/ibkuroyagi/threads_auto/actions ã«ã‚¢ã‚¯ã‚»ã‚¹
2. ã€ŒThreads PDCA Automationã€ã‚’é¸æŠ
3. ã€ŒRun workflowã€ã‚’ã‚¯ãƒªãƒƒã‚¯
4. Mode: `post` ã‚’é¸æŠ
5. å®Ÿè¡Œ

### 2. ãƒ­ã‚°ã‚’ç¢ºèª

ä»¥ä¸‹ã®ãƒ­ã‚°ãŒè¡¨ç¤ºã•ã‚Œã‚Œã°æˆåŠŸã§ã™ï¼š

```
âœ“ ç’°å¢ƒå¤‰æ•°ã®ç¢ºèª
  âœ“ ACCESS_TOKEN: è¨­å®šæ¸ˆã¿ (THAASu6I...)
  âœ“ USER_ID: è¨­å®šæ¸ˆã¿ (1234567890)

ğŸ“… ç¾åœ¨æ™‚åˆ»ï¼ˆJSTï¼‰: 2025-10-30 10:35:00
âœ… æŠ•ç¨¿å¯¾è±¡: 9ä»¶
æ™‚åˆ»ç¯„å›²: 2025-10-30 00:35 ã€œ 2025-10-30 08:55

[1/9] æŠ•ç¨¿ID: 30 | 2025-10-30 00:35 | [ãƒ¡ãƒ³ã‚¿ãƒ«]
  â†’ ã‚³ãƒ³ãƒ†ãƒŠä½œæˆä¸­...
  âœ“ æŠ•ç¨¿æˆåŠŸï¼ (ID: 1234567890_1234567890)
```

---

## ğŸ”„ ãƒˆãƒ¼ã‚¯ãƒ³ã®è‡ªå‹•ãƒã‚§ãƒƒã‚¯ãƒ»æ›´æ–°

### è‡ªå‹•ãƒã‚§ãƒƒã‚¯æ©Ÿèƒ½ï¼ˆæ¨å¥¨ï¼‰

ã“ã®ãƒªãƒã‚¸ãƒˆãƒªã«ã¯ **ãƒˆãƒ¼ã‚¯ãƒ³ã®è‡ªå‹•ãƒã‚§ãƒƒã‚¯æ©Ÿèƒ½** ãŒçµ„ã¿è¾¼ã¾ã‚Œã¦ã„ã¾ã™ã€‚

**å®Ÿè¡Œã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«:**
- **æ¯é€±æ—¥æ›œæ—¥ 20:00 JST** ã«è‡ªå‹•å®Ÿè¡Œ
- ãƒˆãƒ¼ã‚¯ãƒ³ã®æœ‰åŠ¹æ€§ã‚’ç¢ºèª
- æœŸé™åˆ‡ã‚Œã®å ´åˆã¯ GitHub Issue ã§é€šçŸ¥

**ç¢ºèªæ–¹æ³•:**
1. https://github.com/ibkuroyagi/threads_auto/actions ã«ã‚¢ã‚¯ã‚»ã‚¹
2. ã€ŒToken Auto-Refreshã€ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’ç¢ºèª
3. å®Ÿè¡Œçµæœã®ã‚µãƒãƒªãƒ¼ã§ãƒˆãƒ¼ã‚¯ãƒ³ã®çŠ¶æ…‹ã‚’ç¢ºèª

### æ‰‹å‹•æ›´æ–°ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°

é•·æœŸãƒˆãƒ¼ã‚¯ãƒ³ã¯ **60æ—¥é–“** æœ‰åŠ¹ã§ã™ã€‚

- **æ¨å¥¨:** æœ‰åŠ¹æœŸé™ã® **1é€±é–“å‰**
- **æœ€é…:** æœ‰åŠ¹æœŸé™ã® **1æ—¥å‰**

### æ‰‹å‹•æ›´æ–°ã®æ–¹æ³•

1. ä¸Šè¨˜ã®æ‰‹é †ã§æ–°ã—ã„çŸ­æœŸãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—
2. `python3 setup_long_lived_token.py` ã‚’å†å®Ÿè¡Œ
3. GitHub Secrets ã‚’æ›´æ–°

### æœŸé™åˆ‡ã‚Œé€šçŸ¥

ãƒˆãƒ¼ã‚¯ãƒ³ãŒæœŸé™åˆ‡ã‚Œã«ãªã‚‹ã¨ï¼š

1. âœ‰ï¸ **GitHub Issue ãŒè‡ªå‹•ä½œæˆã•ã‚Œã¾ã™**
   - ã‚¿ã‚¤ãƒˆãƒ«: ğŸ”‘ Threads API ãƒˆãƒ¼ã‚¯ãƒ³ãŒæœŸé™åˆ‡ã‚Œã§ã™
   - ãƒ©ãƒ™ãƒ«: `token-expired`, `urgent`, `automation`

2. ğŸ“‹ **å¯¾å‡¦æ‰‹é †ãŒ Issue ã«è¨˜è¼‰ã•ã‚Œã¾ã™**
   - æ–°ã—ã„ãƒˆãƒ¼ã‚¯ãƒ³ã®å–å¾—æ–¹æ³•
   - GitHub Secrets ã®æ›´æ–°æ‰‹é †

3. âœ… **æ›´æ–°å¾Œã€Issue ã‚’ã‚¯ãƒ­ãƒ¼ã‚º**

### ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼è¨­å®š

å¿µã®ãŸã‚ã€`.env` ãƒ•ã‚¡ã‚¤ãƒ«ã®æœŸé™æ—¥ã‚’ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã«ç™»éŒ²ã—ã¦ãŠãã“ã¨ã‚’ãŠã™ã™ã‚ã—ã¾ã™ã€‚

---

## âš ï¸ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ³¨æ„äº‹é …

### âŒ çµ¶å¯¾ã«ã‚„ã£ã¦ã¯ã„ã‘ãªã„ã“ã¨

1. **`.env` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚³ãƒŸãƒƒãƒˆã—ãªã„**
   - ã™ã§ã« `.gitignore` ã«å«ã¾ã‚Œã¦ã„ã¾ã™
   - ç¢ºèª: `git status` ã§ `.env` ãŒè¡¨ç¤ºã•ã‚Œãªã„ã“ã¨

2. **ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å…¬é–‹ã—ãªã„**
   - GitHub Issues, Pull Requests, ã‚³ãƒ¡ãƒ³ãƒˆãªã©ã«è²¼ã‚Šä»˜ã‘ãªã„
   - ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã«å†™ã‚Šè¾¼ã¾ãªã„ã‚ˆã†ã«æ³¨æ„

3. **App Secret ã‚’å…±æœ‰ã—ãªã„**
   - ãƒãƒ¼ãƒ ãƒ¡ãƒ³ãƒãƒ¼ã§ã‚ã£ã¦ã‚‚ã€å¿…è¦æœ€å°é™ã®äººã«ã®ã¿å…±æœ‰

### âœ… ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

1. **å®šæœŸçš„ã«ãƒˆãƒ¼ã‚¯ãƒ³ã‚’æ›´æ–°**
   - 60æ—¥ã”ã¨ã«æ›´æ–°ï¼ˆæœ‰åŠ¹æœŸé™å‰ã«ï¼‰

2. **å¤ã„ãƒˆãƒ¼ã‚¯ãƒ³ã¯ç„¡åŠ¹åŒ–**
   - Meta App ã®è¨­å®šã§å¤ã„ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç„¡åŠ¹åŒ–

3. **ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ã‚’ç¢ºèª**
   - GitHub Actions ã®ãƒ­ã‚°ã§ä¸å¯©ãªæ´»å‹•ãŒãªã„ã‹ç¢ºèª

---

## ğŸ†˜ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚¨ãƒ©ãƒ¼: "Error validating access token"

**åŸå› :** ãƒˆãƒ¼ã‚¯ãƒ³ãŒç„¡åŠ¹ã¾ãŸã¯æœŸé™åˆ‡ã‚Œ

**è§£æ±ºç­–:**
1. æ–°ã—ã„çŸ­æœŸãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—
2. ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å†å®Ÿè¡Œ
3. GitHub Secrets ã‚’æ›´æ–°

### ã‚¨ãƒ©ãƒ¼: "Invalid client_secret"

**åŸå› :** App Secret ãŒé–“é•ã£ã¦ã„ã‚‹

**è§£æ±ºç­–:**
1. Meta App ã® Settings > Basic ã§æ­£ã—ã„ App Secret ã‚’ç¢ºèª
2. ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å†å®Ÿè¡Œ

### ã‚¨ãƒ©ãƒ¼: "Permissions error"

**åŸå› :** å¿…è¦ãªæ¨©é™ãŒä»˜ä¸ã•ã‚Œã¦ã„ãªã„

**è§£æ±ºç­–:**
1. Meta Graph API Explorer ã§æ¨©é™ã‚’ç¢ºèª
2. `threads_basic`, `threads_content_publish` ã‚’æœ‰åŠ¹åŒ–
3. æ–°ã—ã„ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—

---

## ğŸ“ ã‚µãƒãƒ¼ãƒˆ

å•é¡ŒãŒè§£æ±ºã—ãªã„å ´åˆã¯ã€ä»¥ä¸‹ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼š

1. **Threads API ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**
   https://developers.facebook.com/docs/threads

2. **Meta for Developers ã‚µãƒãƒ¼ãƒˆ**
   https://developers.facebook.com/support/

3. **ã“ã®ãƒªãƒã‚¸ãƒˆãƒªã® Issues**
   https://github.com/ibkuroyagi/threads_auto/issues
