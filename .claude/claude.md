# Threads自動投稿プロジェクト - Claude Code セッションガイド

## 🚨 新しいセッションで最初にすべきこと

### 1. 必須ドキュメントを読む

#### POSTING_GUIDELINES.md（最優先）
**新しい投稿を作成する前に必ず読む：** 過去の指摘事項をまとめたガイドライン

- 極端にならない（バランスが最重要）
- 3つのタイプの混在（短文・Tips・権威性）
- 検証可能な数値は書かない
- トピックは1投稿につき1つ
- 意識高すぎないキーワード選定

```bash
# 投稿作成前に必ず確認
cat POSTING_GUIDELINES.md
```

#### learnings.md（仮説検証ログ）
**最重要:** このプロジェクトには仮説検証の学習ログ `learnings.md` があります。
新しいセッションを開始したら、**必ず最初に learnings.md を読んでください。**

理由:
- 過去の仮説とその成功/失敗パターンが記録されている
- 同じ失敗を繰り返さないための知見が蓄積されている
- 現在の投稿戦略（短文メタ60% + 厳選長文40%）の根拠が記載されている

```bash
# 必ず最初に実行
cat learnings.md
```

### 2. 現在の運用方針（2025-10-31時点）

#### 投稿戦略の本質
**成功の本質: 「中に人がいる感じ」「リアルな成長過程」**
- ✓ 試行錯誤している様子を記録する
- ✓ 学びを得て頑張っている姿を見せる
- ✓ 失敗も含めた成長の記録
- ✗ AI的な教科書的コンテンツは避ける
- ✗ 誰が書いたかわからない一般論は避ける

**バランス型投稿構成（63投稿）:**
- リアルタイム試行錯誤: 18投稿（29%）
- 体験談ベースノウハウ: 25投稿（40%）
- 役立つノウハウ: 20投稿（31%）

**スパム判定対策（重要）:**
- 数字は1-2個まで（羅列NG）
- 箇条書きは3個まで（多用NG）
- Before/After形式は避ける
- 感情表現を必ず入れる
- 完成形を避ける（「3日目」「続けられるかな」）

#### 削除されたトピック（仮説失敗）
以下のトピックは効果が低いため削除済み。今後追加しないこと:
- 占い系: タロット占い、数秘術、月星座
- 概念的: HSP、自己肯定感、完璧主義、ポジティブ思考
- 抽象的批判: 報連相、燃え尽き症候群、社会批判系

#### 成功トピック
- お金: NISA、貯金術、節約術など具体的アクション
- 恋愛: 元カレ、マッチングアプリなど具体的シーン
- 生活: ミニマル暮らしなどポジティブなライフスタイル

### 3. プロジェクト構造（2025-10-31 システム設計刷新）

#### 🎯 シンプルアーキテクチャ

**単一の信頼できる情報源:**
- `posts_schedule.csv`: すべての投稿（永久保存、削除しない）
- `.last_posted_at`: 最終実行時刻（自動更新）

**仕組み:**
```
scheduled_at が (last_posted_at, now] の範囲 → 投稿
```

**メリット:**
- ✅ 冪等性（何度実行しても同じ結果）
- ✅ 同期問題ゼロ
- ✅ シンプル（バグが入りにくい）

#### 重要ファイル
- `posts_schedule.csv`: 予約投稿マスターデータ（すべての投稿、永久保存）
- `.last_posted_at`: 最終実行時刻（automation ブランチで管理）
- `learnings.md`: 仮説検証ログ（PDCA改善履歴）

#### ブランチ戦略
- `main`: 開発・新規投稿追加（手動）
- `automation`: 実行状態の自動更新（GitHub Actions）
- 毎日0時に automation → main を自動マージ

#### 実行スクリプト
- `threads_simple.py`: **メイン投稿スクリプト（新）**
  - 時間範囲ベースの投稿（シンプル）
  - `--dry-run`: テスト実行
- `threads_sqlite.py`: レポート生成用（旧）
  - `daily-report`: 毎朝の成果報告生成
  - `update-learnings`: 学習ログ更新

### 4. 日次レポートについて

毎朝のレポートフォーマット:
```
おはよう☀️
運用開始して{N}日目の成果報告！

【投稿数】X投稿
【いいね】X件（平均X.X）
【インプレッション】X,XXX回
【フォロワー】XX人（前日比+X人👆）

[モチベーションメッセージ]
```

運用開始日: 2025-10-29

### 5. トラブルシューティング

#### トークンエラーが出た場合
`.env` ファイルに重複エントリがないか確認:
```bash
grep THREADS_ACCESS_TOKEN .env
```

#### 投稿データの確認
```bash
# 現在のpending投稿数
sqlite3 threads.db "SELECT COUNT(*) FROM posts WHERE status='pending'"

# 昨日の投稿パフォーマンス
python3 threads_sqlite.py daily-report
```

### 6. 新しい投稿を追加する場合の注意

learnings.md の成功パターンに基づいて、以下を確認:
1. **「中に人がいる」感じがあるか？**
   - リアルな体験・試行錯誤が見えるか？
   - 誰が書いても同じ一般論ではないか？
2. **具体的で実用的なトピックか？**
3. **ポジティブな内容か？**
4. **専門用語や概念的すぎる内容ではないか？**

**NG例:** AI的な教科書的コンテンツ（「○○の5つのステップ」など誰が書いても同じ内容）
**OK例:** 自分の失敗談、試行錯誤の記録、学びのプロセス

---

## 📝 更新履歴

### 2025-10-31 午後（短文・高頻度投稿への転換）
- **投稿戦略を短文・高頻度に変更**
- 1日24投稿（6回実行 × 4投稿、Daily Report含め25投稿）
- 投稿間隔: 6分
- 実行時間: 8時、12時、15時、18時、21時、23時（JST）
- トピック設定機能追加（Threads API対応）
- POSTING_GUIDELINES.md 作成（指摘事項まとめ）
- 重要な指摘:
  - 「極端にならない」- バランスが最重要
  - 3つのタイプを混在（短文・Tips・権威性）
  - 検証可能な数値は書かない（フォロワー数など）
  - トピックは1投稿につき1つ
  - 意識高すぎるキーワードを避ける（眠い、疲れた、残業など普通の検索ワード）

### 2025-10-31 午前（重大アーキテクチャ刷新）
- **システム設計の大幅簡略化**
- posted_history.csv 完全廃止
- threads.db 完全廃止
- 新スクリプト threads_simple.py 実装
- 単一の信頼できる情報源: posts_schedule.csv + .last_posted_at
- タイムゾーンバグ修正（UTC → JST統一）
- learnings.md システムを構築
- 初回の仮説検証結果を記録（35投稿の分析）
- 本質的気づき: 「中に人がいる感じ」「リアルな成長過程」が成功の鍵
- 低パフォーマンス12トピックを削除（63→51投稿）
- AI的教科書コンテンツからの脱却
- スパム判定対策（数字・箇条書き制限）
